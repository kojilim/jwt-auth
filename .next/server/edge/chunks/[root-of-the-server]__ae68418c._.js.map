{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import stream)"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`stream`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import crypto)"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`crypto`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 41, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/lib/auth.ts"],"sourcesContent":["import jwt, { SignOptions, JwtPayload } from \"jsonwebtoken\";\n\nconst JWT_SECRET = process.env.JWT_SECRET;\n\nif (!JWT_SECRET) {\n    throw new Error(\"JWT_SECRET is not defined in environment variables\");\n}\n\nexport function signToken(payload: JwtPayload, expiresIn: SignOptions[\"expiresIn\"] = \"15m\"): string {\n    const options: SignOptions = { expiresIn };\n    return jwt.sign(payload, JWT_SECRET as string, options);\n}\n\nexport function verifyToken(token: string): JwtPayload {\n    return jwt.verify(token, JWT_SECRET as string) as JwtPayload;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AAEzC,IAAI,CAAC,YAAY;IACb,MAAM,IAAI,MAAM;AACpB;AAEO,SAAS,UAAU,OAAmB,EAAE,YAAsC,KAAK;IACtF,MAAM,UAAuB;QAAE;IAAU;IACzC,OAAO,6IAAA,CAAA,UAAG,CAAC,IAAI,CAAC,SAAS,YAAsB;AACnD;AAEO,SAAS,YAAY,KAAa;IACrC,OAAO,6IAAA,CAAA,UAAG,CAAC,MAAM,CAAC,OAAO;AAC7B"}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport type { NextRequest } from \"next/server\";\nimport { verifyToken } from \"@/lib/auth\";\n\nexport function middleware(request: NextRequest) {\n  const token = request.cookies.get(\"auth_token\")?.value;\n\n  if (!token) {\n    return NextResponse.redirect(new URL(\"/sign-in\", request.url));\n  }\n\n  try {\n    verifyToken(token);\n    return NextResponse.next();\n  } catch {\n    return NextResponse.redirect(new URL(\"/sign-in\", request.url));\n  }\n}\n\nexport const config = {\n  matcher: [\"/dashboard/:path*\"],  // protect dashboard and subroutes\n};\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAEA;;;AAEO,SAAS,WAAW,OAAoB;IAC7C,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;IAEjD,IAAI,CAAC,OAAO;QACV,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,YAAY,QAAQ,GAAG;IAC9D;IAEA,IAAI;QACF,CAAA,GAAA,0HAAA,CAAA,cAAW,AAAD,EAAE;QACZ,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC1B,EAAE,OAAM;QACN,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,YAAY,QAAQ,GAAG;IAC9D;AACF;AAEO,MAAM,SAAS;IACpB,SAAS;QAAC;KAAoB;AAChC"}}]
}