{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import stream)"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`stream`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 36, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import crypto)"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`crypto`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,MAAM,CAAC"}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import fs)"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`fs`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,EAAE,CAAC"}},
    {"offset": {"line": 48, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import path)"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`path`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,IAAI,CAAC"}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/ (unsupported edge import os)"],"sourcesContent":["__turbopack_context__.n(__import_unsupported(`os`));\n"],"names":[],"mappings":"AAAA,sBAAsB,CAAC,CAAC,qBAAqB,CAAC,EAAE,CAAC"}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/lib/auth.ts"],"sourcesContent":["import jwt, { SignOptions, JwtPayload } from \"jsonwebtoken\";\nimport dotenv from \"dotenv\";\ndotenv.config();\n\nconst JWT_SECRET = process.env.JWT_SECRET;\n\nif (!JWT_SECRET) {\n    throw new Error(\"JWT_SECRET is not defined in environment variables\");\n}\n\nexport function signToken(payload: JwtPayload, expiresIn: SignOptions[\"expiresIn\"] = \"15m\"): string {\n    const options: SignOptions = { expiresIn };\n    return jwt.sign(payload, JWT_SECRET as string, options);\n}\n\nexport function verifyToken(token: string): JwtPayload {\n    return jwt.verify(token, JWT_SECRET as string) as JwtPayload;\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AACA,6IAAA,CAAA,UAAM,CAAC,MAAM;AAEb,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AAEzC,IAAI,CAAC,YAAY;IACb,MAAM,IAAI,MAAM;AACpB;AAEO,SAAS,UAAU,OAAmB,EAAE,YAAsC,KAAK;IACtF,MAAM,UAAuB;QAAE;IAAU;IACzC,OAAO,6IAAA,CAAA,UAAG,CAAC,IAAI,CAAC,SAAS,YAAsB;AACnD;AAEO,SAAS,YAAY,KAAa;IACrC,OAAO,6IAAA,CAAA,UAAG,CAAC,MAAM,CAAC,OAAO;AAC7B"}},
    {"offset": {"line": 85, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/middleware.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport type { NextRequest } from \"next/server\";\nimport { verifyToken } from \"@/lib/auth\";\n\nexport function middleware(request: NextRequest) {\n    const token = request.cookies.get(\"auth_token\")?.value;\n\n    if (!token) {\n        return NextResponse.redirect(new URL(\"/login\", request.url));\n    }\n\n    try {\n        verifyToken(token); // throws if invalid\n        return NextResponse.next();\n    } catch (err) {\n        return NextResponse.redirect(new URL(\"/login\", request.url));\n    }\n}\n\n// Protect only these paths\nexport const config = {\n    matcher: [\"/dashboard/:path*\", \"/admin/:path*\"],\n};\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAEA;;;AAEO,SAAS,WAAW,OAAoB;IAC3C,MAAM,QAAQ,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe;IAEjD,IAAI,CAAC,OAAO;QACR,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;IAC9D;IAEA,IAAI;QACA,CAAA,GAAA,0HAAA,CAAA,cAAW,AAAD,EAAE,QAAQ,oBAAoB;QACxC,OAAO,6LAAA,CAAA,eAAY,CAAC,IAAI;IAC5B,EAAE,OAAO,KAAK;QACV,OAAO,6LAAA,CAAA,eAAY,CAAC,QAAQ,CAAC,IAAI,IAAI,UAAU,QAAQ,GAAG;IAC9D;AACJ;AAGO,MAAM,SAAS;IAClB,SAAS;QAAC;QAAqB;KAAgB;AACnD"}}]
}