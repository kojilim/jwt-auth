{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 98, "column": 0}, "map": {"version":3,"sources":["file:///Users/koji/Desktop/auth/src/lib/auth.ts"],"sourcesContent":["import jwt, { SignOptions, JwtPayload } from \"jsonwebtoken\";\n\nconst JWT_SECRET = process.env.JWT_SECRET;\n\nif (!JWT_SECRET) {\n    throw new Error(\"JWT_SECRET is not defined in environment variables\");\n}\n\nexport function signToken(payload: JwtPayload, expiresIn: SignOptions[\"expiresIn\"] = \"15m\"): string {\n    const options: SignOptions = { expiresIn };\n    return jwt.sign(payload, JWT_SECRET as string, options);\n}\n\nexport function verifyToken(token: string): JwtPayload {\n    return jwt.verify(token, JWT_SECRET as string) as JwtPayload;\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU;AAEzC,IAAI,CAAC,YAAY;IACb,MAAM,IAAI,MAAM;AACpB;AAEO,SAAS,UAAU,OAAmB,EAAE,YAAsC,KAAK;IACtF,MAAM,UAAuB;QAAE;IAAU;IACzC,OAAO,uIAAA,CAAA,UAAG,CAAC,IAAI,CAAC,SAAS,YAAsB;AACnD;AAEO,SAAS,YAAY,KAAa;IACrC,OAAO,uIAAA,CAAA,UAAG,CAAC,MAAM,CAAC,OAAO;AAC7B","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///Users/koji/Desktop/auth/src/lib/bcrypt.ts"],"sourcesContent":["import bcrypt from \"bcrypt\";\n\nexport async function hashPassword(password: string) {\n    return bcrypt.hash(password, 10);\n}\n\nexport async function comparePassword(\n    plainPassword: string,\n    hashedPassword: string\n) {\n    return bcrypt.compare(plainPassword, hashedPassword);\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,aAAa,QAAgB;IAC/C,OAAO,qGAAA,CAAA,UAAM,CAAC,IAAI,CAAC,UAAU;AACjC;AAEO,eAAe,gBAClB,aAAqB,EACrB,cAAsB;IAEtB,OAAO,qGAAA,CAAA,UAAM,CAAC,OAAO,CAAC,eAAe;AACzC","debugId":null}},
    {"offset": {"line": 217, "column": 0}, "map": {"version":3,"sources":["file:///Users/koji/Desktop/auth/src/db/schema.ts"],"sourcesContent":["import { mysqlTable, serial, varchar, text } from \"drizzle-orm/mysql-core\";\n\nexport const users = mysqlTable(\"users\", {\n    id: serial(\"id\").primaryKey(),\n    username: varchar(\"username\", { length: 255 }).notNull().unique(),\n    passwordHash: text(\"passwordHash\").notNull(),\n    role: varchar(\"role\", { length: 50 }).notNull().default(\"user\"),\n});\n"],"names":[],"mappings":";;;AAAA;AAAA;AAAA;AAAA;;AAEO,MAAM,QAAQ,CAAA,GAAA,0JAAA,CAAA,aAAU,AAAD,EAAE,SAAS;IACrC,IAAI,CAAA,GAAA,sKAAA,CAAA,SAAM,AAAD,EAAE,MAAM,UAAU;IAC3B,UAAU,CAAA,GAAA,uKAAA,CAAA,UAAO,AAAD,EAAE,YAAY;QAAE,QAAQ;IAAI,GAAG,OAAO,GAAG,MAAM;IAC/D,cAAc,CAAA,GAAA,oKAAA,CAAA,OAAI,AAAD,EAAE,gBAAgB,OAAO;IAC1C,MAAM,CAAA,GAAA,uKAAA,CAAA,UAAO,AAAD,EAAE,QAAQ;QAAE,QAAQ;IAAG,GAAG,OAAO,GAAG,OAAO,CAAC;AAC5D","debugId":null}},
    {"offset": {"line": 263, "column": 0}, "map": {"version":3,"sources":["file:///Users/koji/Desktop/auth/src/app/api/auth/login/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { cookies } from \"next/headers\";\nimport { signToken } from \"@/lib/auth\";\nimport { comparePassword } from \"@/lib/bcrypt\";\nimport { drizzle } from \"drizzle-orm/mysql2\";\nimport mysql from \"mysql2/promise\";\nimport { users } from \"@/db/schema\";\nimport { eq } from \"drizzle-orm\";\nimport * as dotenv from \"dotenv\";\n\ndotenv.config();\n\nexport async function POST(req: Request) {\n    try {\n        const { username, password } = await req.json();\n\n        const connection = await mysql.createConnection({\n            host: process.env.DATABASE_HOST!,\n            port: Number(process.env.DATABASE_PORT!),\n            user: process.env.DATABASE_USER!,\n            password: process.env.DATABASE_PASSWORD!,\n            database: process.env.DATABASE_NAME!,\n        });\n\n        const db = drizzle(connection);\n\n        const [user] = await db\n            .select()\n            .from(users)\n            .where(eq(users.username, username))\n            .limit(1);\n\n        await connection.end();\n\n        if (!user) {\n            return NextResponse.json(\n                { success: false, message: \"Invalid username or password\" },\n                { status: 401 }\n            );\n        }\n\n        const passwordMatch = await comparePassword(password, user.passwordHash);\n\n        if (!passwordMatch) {\n            return NextResponse.json(\n                { success: false, message: \"Invalid username or password\" },\n                { status: 401 }\n            );\n        }\n\n        const token = signToken({ userId: user.id, role: user.role });\n\n        const cookieStore = await cookies();\n        cookieStore.set(\"auth_token\", token, {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === \"production\",\n            sameSite: \"strict\",\n            path: \"/\",\n            maxAge: 60 * 15, // 15 minutes\n        });\n\n        return NextResponse.json({ success: true, message: \"Login successful\" });\n    } catch (error) {\n        console.error(\"Login error:\", error);\n        return NextResponse.json(\n            { success: false, message: \"Internal server error\" },\n            { status: 500 }\n        );\n    }\n}\n"],"names":[],"mappings":";;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;AAEA,uIAAA,CAAA,SAAa;AAEN,eAAe,KAAK,GAAY;IACnC,IAAI;QACA,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,IAAI,IAAI;QAE7C,MAAM,aAAa,MAAM,mIAAA,CAAA,UAAK,CAAC,gBAAgB,CAAC;YAC5C,MAAM,QAAQ,GAAG,CAAC,aAAa;YAC/B,MAAM,OAAO,QAAQ,GAAG,CAAC,aAAa;YACtC,MAAM,QAAQ,GAAG,CAAC,aAAa;YAC/B,UAAU,QAAQ,GAAG,CAAC,iBAAiB;YACvC,UAAU,QAAQ,GAAG,CAAC,aAAa;QACvC;QAEA,MAAM,KAAK,CAAA,GAAA,oKAAA,CAAA,UAAO,AAAD,EAAE;QAEnB,MAAM,CAAC,KAAK,GAAG,MAAM,GAChB,MAAM,GACN,IAAI,CAAC,qHAAA,CAAA,QAAK,EACV,KAAK,CAAC,CAAA,GAAA,oKAAA,CAAA,KAAE,AAAD,EAAE,qHAAA,CAAA,QAAK,CAAC,QAAQ,EAAE,WACzB,KAAK,CAAC;QAEX,MAAM,WAAW,GAAG;QAEpB,IAAI,CAAC,MAAM;YACP,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;gBAAO,SAAS;YAA+B,GAC1D;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,gBAAgB,MAAM,CAAA,GAAA,sHAAA,CAAA,kBAAe,AAAD,EAAE,UAAU,KAAK,YAAY;QAEvE,IAAI,CAAC,eAAe;YAChB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACpB;gBAAE,SAAS;gBAAO,SAAS;YAA+B,GAC1D;gBAAE,QAAQ;YAAI;QAEtB;QAEA,MAAM,QAAQ,CAAA,GAAA,oHAAA,CAAA,YAAS,AAAD,EAAE;YAAE,QAAQ,KAAK,EAAE;YAAE,MAAM,KAAK,IAAI;QAAC;QAE3D,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;QAChC,YAAY,GAAG,CAAC,cAAc,OAAO;YACjC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,MAAM;YACN,QAAQ,KAAK;QACjB;QAEA,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,SAAS;QAAmB;IAC1E,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gBAAgB;QAC9B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACpB;YAAE,SAAS;YAAO,SAAS;QAAwB,GACnD;YAAE,QAAQ;QAAI;IAEtB;AACJ","debugId":null}}]
}